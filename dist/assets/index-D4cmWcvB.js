let a=Object.getPrototypeOf,p,c,o,i,j={isConnected:1},H=1e3,b,v={},J=a(j),k=a(a),_,x=(e,t,r,l)=>(e??(setTimeout(r,l),new Set)).add(t),I=(e,t,r)=>{let l=o;o=t;try{return e(r)}catch(n){return console.error(n),r}finally{o=l}},u=e=>e.filter(t=>{var r;return(r=t._dom)==null?void 0:r.isConnected}),M=e=>b=x(b,e,()=>{for(let t of b)t._bindings=u(t._bindings),t._listeners=u(t._listeners);b=_},H),V={get val(){var e;return(e=o==null?void 0:o._getters)==null||e.add(this),this.rawVal},get oldVal(){var e;return(e=o==null?void 0:o._getters)==null||e.add(this),this._oldVal},set val(e){var t;(t=o==null?void 0:o._setters)==null||t.add(this),e!==this.rawVal&&(this.rawVal=e,this._bindings.length+this._listeners.length?(c==null||c.add(this),p=x(p,this,N)):this._oldVal=e)}},W=e=>({__proto__:V,rawVal:e,_oldVal:e,_bindings:[],_listeners:[]}),w=(e,t)=>{let r={_getters:new Set,_setters:new Set},l={f:e},n=i;i=[];let d=I(e,r,t);d=(d??document).nodeType?d:new Text(d);for(let s of r._getters)r._setters.has(s)||(M(s),s._bindings.push(l));for(let s of i)s._dom=d;return i=n,l._dom=d},y=(e,t=W(),r)=>{let l={_getters:new Set,_setters:new Set},n={f:e,s:t};n._dom=r??(i==null?void 0:i.push(n))??j,t.val=I(e,l,t.rawVal);for(let d of l._getters)l._setters.has(d)||(M(d),d._listeners.push(n));return t},G=(e,...t)=>{for(let r of t.flat(1/0)){let l=a(r??0),n=l===V?w(()=>r.val):l===k?w(r):r;n!=_&&e.append(n)}return e},L=(e,t,...r)=>{var O;let[{is:l,...n},...d]=a(r[0]??0)===J?r:[{},...r],s=e?document.createElementNS(e,t,{is:l}):document.createElement(t,{is:l});for(let[f,h]of Object.entries(n)){let P=g=>g?Object.getOwnPropertyDescriptor(g,f)??P(a(g)):_,m=t+","+f,C=v[m]??(v[m]=((O=P(a(s)))==null?void 0:O.set)??0),A=f.startsWith("on")?(g,F)=>{let E=f.slice(2);s.removeEventListener(E,F),s.addEventListener(E,g)}:C?C.bind(s):s.setAttribute.bind(s,f),S=a(h??0);f.startsWith("on")||S===k&&(h=y(h),S=V),S===V?w(()=>(A(h.val,h._oldVal),s)):A(h)}return G(s,d)},T=e=>({get:(t,r)=>L.bind(_,e,r)}),B=(e,t)=>t?t!==e&&e.replaceWith(t):e.remove(),N=()=>{let e=0,t=[...p].filter(l=>l.rawVal!==l._oldVal);do{c=new Set;for(let l of new Set(t.flatMap(n=>n._listeners=u(n._listeners))))y(l.f,l.s,l._dom),l._dom=_}while(++e<100&&(t=[...c]).length);let r=[...p].filter(l=>l.rawVal!==l._oldVal);p=_;for(let l of new Set(r.flatMap(n=>n._bindings=u(n._bindings))))B(l._dom,w(l.f,l._dom)),l._dom=_;for(let l of r)l._oldVal=l.rawVal};const q={tags:new Proxy(e=>new Proxy(L,T(e)),T()),hydrate:(e,t)=>B(e,w(t,e)),add:G,state:W,derive:y};q.add(document.getElementById("app"),()=>"Hello JS13k");
